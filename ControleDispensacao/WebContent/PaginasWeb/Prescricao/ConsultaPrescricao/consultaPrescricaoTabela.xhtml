<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:p="http://primefaces.prime.com.tr/ui"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets">

	<p:dataTable 	id="tabelaConsultaPrescricao" 
					value="#{consultaPrescricaoConsulta.list}" 
					var="linha"
					dblClickSelect="true"
					emptyMessage="Não foi encontrado registros" 
					rows="10" 
					paginator="true"
					selectionMode="single" 
					rowKey="#{linha.idPrescricao}">
					
		<p:column>
			<f:facet name="header"><h:outputText value="Nome" /></f:facet>
			<h:outputText value="#{linha.paciente.nome}" />
		</p:column>
					
		<p:column>
			<f:facet name="header"><h:outputText value="Leito" /></f:facet>
			<h:outputText value="#{linha.leito}" />
		</p:column>
		
		<p:column>
			<f:facet name="header"><h:outputText value="Profissional" /></f:facet>
			<h:outputText value="#{linha.profissionalConclusao.nome}" />
		</p:column>
		
		<p:column>
			<f:facet name="header"><h:outputText value="Data de conclusão" /></f:facet>
			<h:outputText value="#{linha.dataConclusao}">
				<f:convertDateTime pattern="dd/MM/yyyy HH:mm"/>
			</h:outputText>
		</p:column>
		
		<p:column style="width:60px; text-align: center;" >
			<p:commandLink update="padraoTabView:consultaPrescricaoForm" 
						   title="Editar" 
						   style="padding-right:10px;" >
				<f:setPropertyActionListener value="#{linha}" target="#{tipoMovimentoHome.instancia}" />
				<h:graphicImage value="/Imagens/edit.gif" />
			</p:commandLink>
			
			<p:commandLink  onclick="bloqueioDialog.show()"
							update="tabelaConsultaPrescricao padraoTabView:consultaPrescricaoForm" 
							title="Bloquear" 
							style="padding-right:10px;" >
				<f:setPropertyActionListener value="#{linha}" target="#{prescricaoHome.prescricaoBloqueio}" />
				<h:graphicImage value="/Imagens/block.png" width="16px" height="16px" />
			</p:commandLink>
		</p:column>  
	</p:dataTable>
	
	<p:dialog header="Motivo Bloqueio" 
			  closable="true" 
			  modal="true"
			  widgetVar="bloqueioDialog">
		
		<font color="red" >*</font><h:outputLabel for="motivo" value="Motivo:" /><br />
		<p:inputTextarea id="motivo"
						 rows="10"
						 cols="30"
						 value="#{prescricaoHome.prescricaoBloqueio.motivoBloqueio}" />
		<p:commandButton value="Gravar"
						 oncomplete="bloqueioDialog.hide()"
						 update="padraoTabView:tabelaConsultaPrescricao"
						 action="#{prescricaoHome.bloqueiarPrescricao()}" />
	</p:dialog>
	
</ui:composition>