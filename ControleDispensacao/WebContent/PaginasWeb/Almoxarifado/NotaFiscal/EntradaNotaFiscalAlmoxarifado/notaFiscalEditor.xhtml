<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ri="http://java.sun.com/jsf/composite/remendo/input"
	xmlns:p="http://primefaces.org/ui">

	<h:panelGrid id="notaFiscalAlmoxarifadoPanelGrid" columns="3" width="100%">
		<ri:inputAutoComplete id="fornecedor" 
							  label="Fornecedor" 
							  completeMethod="#{fornecedorAutoComplete.autoCompleteCnpj}" 
							  itemValue="#{fornecedor}" 
							  itemLabel="#{fornecedor.nome}"
							  title="Informe o CNPJ" 
							  var="fornecedor" 
							  value="#{notaFiscalAlmoxarifadoRaiz.instancia.fornecedor}" 
							  required="true"/>
		
		<ri:inputApenasNumeroSemZeroEsquerda 
							 id="identificacaoNotaFiscal" 
							 title="Informe o número da nota fiscal" 
							 value="#{notaFiscalAlmoxarifadoRaiz.instancia.identificacao}" 
							 label="Identificação da Nota"
							 required="true" />
		
		<ri:inputApenasNumeroSemZeroEsquerda 
							 id="serieNotaFiscal" 
							 title="Informe o número de série da nota fiscal" 
							 value="#{notaFiscalAlmoxarifadoRaiz.instancia.serie}" 
							 label="Série"
							 required="true" />
		
		<ri:inputDataHora id="dataEmissao"
						  required="true" 
						  title="Informe a data de emissão da nota" 
						  value="#{notaFiscalAlmoxarifadoRaiz.instancia.dataEmissao}" 
						  label="Data de Emissão" />
						  
		<ri:inputDataHora id="dataEntrega"
						  required="true" 
						  title="Informe a data de entrega da nota" 
						  value="#{notaFiscalAlmoxarifadoRaiz.instancia.dataEntrega}" 
						  label="Data de Entrega" />
		
		<ri:inputDataHora id="dataContabil"
						  required="true" 
						  title="Informe a data em que o financeiro irá computar a nota-fiscal" 
						  value="#{notaFiscalAlmoxarifadoRaiz.instancia.dataContabil}" 
						  label="Data Contábil" />
		
		<ri:inputValorFracionado id="valorTotal" 
								 required="true"
								 title="Informe o valor total da nota fiscal" 
								 value="#{notaFiscalAlmoxarifadoRaiz.instancia.valorTotal}" 
								 label="Valor Total" />
		
		<ri:inputValorFracionado id="valorDesconto" 
								 title="Informe o valor do desconto" 
								 value="#{notaFiscalAlmoxarifadoRaiz.instancia.valorDesconto}" 
								 label="Valor do Desconto" />
		
		<ri:inputApenasNumero id="codigo" 
							  title="Informe a chave de validação da nota fiscal" 
							  value="#{notaFiscalAlmoxarifadoRaiz.instancia.chaveAcesso}" 
							  label="Chave" />
		
		<ri:inputSelectOneRadioBoolean id="doacao" 
									   value="#{notaFiscalAlmoxarifadoRaiz.instancia.doacao}" 
									   label="Doação" />
									   
		
	</h:panelGrid>
	
	<p:separator id="separator" rendered="#{notaFiscalAlmoxarifadoRaiz.edicao}" />
	  
	<h:outputText id="outPutTextItens"
				  style="font-weight:bold;"
				  value="Itens da Nota Fiscal" 
				  rendered="#{notaFiscalAlmoxarifadoRaiz.edicao}" />
	<div align="left" > 
		<h:panelGrid id="notaFiscalEstoquePanelGridBuscaLote"
					 columns="3"
					 rendered="#{notaFiscalAlmoxarifadoRaiz.edicao}">
			<ri:inputTextoSimples id="lote" 
							  title="Informe o lote" 
							  disabled="#{notaFiscalAlmoxarifadoRaiz.achouLote != null}"
							  value="#{notaFiscalAlmoxarifadoRaiz.item.estoqueAlmoxarifado.lote}" 
							  label="Lote"
							  required="false" />
			<p:commandButton image="ui-icon ui-icon-search"
							 update=":#{p:component('notaFiscalAlmoxarifadoEditorForm')}"
							 action="#{notaFiscalAlmoxarifadoRaiz.procurarLote}" 
							 rendered="#{notaFiscalAlmoxarifadoRaiz.achouLote == null}"
							 title="Procurar lote" />
			<h:message />
		</h:panelGrid>
	</div>

	<h:panelGrid id="itensNotaFiscalAlmoxarifadoPanelGrid"
				 width="100%" 
				 columns="3" 
				 rendered="#{notaFiscalAlmoxarifadoRaiz.achouLote != null and notaFiscalAlmoxarifadoRaiz.edicao}" >
				 
		<ri:inputAutoComplete id="material" 
							 label="Material"  
							 disabled="#{notaFiscalAlmoxarifadoRaiz.achouLote}"
							 completeMethod="#{materialAlmoxarifadoAutoComplete.autoComplete}" 
							 itemValue="#{material}" 
							 itemLabel="#{material.descricaoUnidadeMaterial}" 
							 var="material"
							 value="#{notaFiscalAlmoxarifadoRaiz.item.estoqueAlmoxarifado.materialAlmoxarifado}" 
							 required="true"/>
		
		<ri:inputAutoComplete id="fabricante" 
							 label="Fabricante"  
							 disabled="#{notaFiscalAlmoxarifadoRaiz.achouLote}"
							 completeMethod="#{fabricanteAlmoxarifadoAutoComplete.autoComplete}" 
							 itemValue="#{fabricante}" 
							 itemLabel="#{fabricante.descricao}" 
							 var="fabricante"
							 value="#{notaFiscalAlmoxarifadoRaiz.item.estoqueAlmoxarifado.fabricanteAlmoxarifado}" 
							 required="true"/>
		
		<ri:inputDataDiaMesAno id="dataValidade"
						   label="Data de Validade"
						   rendered="#{!doacaoRaiz.loteEncontrado and !doacaoRaiz.edicao}"
						   disabled="#{notaFiscalAlmoxarifadoRaiz.achouLote}"
						   required="true" 
						   value="#{notaFiscalAlmoxarifadoRaiz.item.estoqueAlmoxarifado.dataValidade}"
						   title="Data de validade do lote"/>
		
		<ri:inputApenasNumero id="quantidade" 
							  title="Informe a quantidade informada na nota" 
							  value="#{notaFiscalAlmoxarifadoRaiz.quantidadeMovimentada}" 
							  label="Quantidade"/>
		
		<ri:inputValorFracionado id="valorUnitario" 
								 title="Informe o valor unitário do medicamento" 
								 value="#{notaFiscalAlmoxarifadoRaiz.item.valorUnitario}" 
								 label="Valor Unitário" />
		
		<ri:inputTextoSimples id="codigoBarras" 
							  title="Informe o código de barras" 
							  value="#{notaFiscalAlmoxarifadoRaiz.item.estoqueAlmoxarifado.codigoBarras}" 
							  label="Código de Barras" />
	</h:panelGrid>
	<h:panelGrid id="botoesNotaFiscalAlmoxarifadoPanelGrid"
				 width="100%" 
				 columns="3" 
				 rendered="#{notaFiscalAlmoxarifadoRaiz.edicao}" >
		<h:panelGroup>
			<p:commandButton value="Adicionar" 
							 action="#{notaFiscalAlmoxarifadoRaiz.addItemNotaFiscal}" 
							 rendered="#{notaFiscalAlmoxarifadoRaiz.achouLote != null}"
							 update=":#{p:component('notaFiscalAlmoxarifadoEditorForm')}" />
			<p:commandButton value="Limpar" 
							 immediate="true"
							 rendered="#{notaFiscalAlmoxarifadoRaiz.achouLote != null}"
							 action="#{notaFiscalAlmoxarifadoRaiz.cancelarItem}" 
							 update=":#{p:component('notaFiscalAlmoxarifadoEditorForm')}" />
		</h:panelGroup>
	</h:panelGrid>
	<br/>
	
	<div align="left">
	
		<p:dataGrid id="itensEstoqueAlmoxarifadoDataGrid"
					var="linha" 
					emptyMessage="Não foi encontrado registros."
					value="#{notaFiscalAlmoxarifadoRaiz.instancia.itens}"
					columns="3"
					rendered="#{notaFiscalAlmoxarifadoRaiz.edicao}"
					rows="5" 
					paginator="true" 
	        		paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"  
	        		rowsPerPageTemplate="5,10,15">
	  
			<p:panel style="text-align:center;" >
				<f:facet name="header" >
					<h:panelGrid width="100%" 
								 columns="2" 
								 style=" 
								 height:16px;" >
						Lote: #{linha.estoqueAlmoxarifado.lote}
						<h:panelGroup rendered="#{!notaFiscalAlmoxarifadoRaiz.instancia.bloqueada and !notaFiscalAlmoxarifadoRaiz.instancia.fechada}" >
							<div align="right">
								<p:commandLink  rendered="false"
												update=":#{p:component('notaFiscalAlmoxarifado')} :#{p:component('itensEstoqueAlmoxarifadoDataGrid')}"
												onclick="if(!confirm('Deseja realmente excluir?')) return false;"
												title="Apagar" style="padding-right:10px;">
									<h:graphicImage value="/Imagens/delete.png" />
								</p:commandLink>
							</div>
						</h:panelGroup>
					</h:panelGrid>
				</f:facet>
				<h:panelGrid columns="1" style="width:100%">
	                <h:panelGroup>
	                	<h:outputText value="Material: " style="font-weight:bold;" /><br/>
	  			       	<h:outputText value=" #{linha.estoqueAlmoxarifado.materialAlmoxarifado.descricao}"/>
	                </h:panelGroup>
	            </h:panelGrid>
	            <h:panelGrid columns="3" style="width:100%">  
	                
	                <h:panelGroup>
	                	<h:outputText value="Fabricante: " style="font-weight:bold;" /><br/>
				        <h:outputText value="#{linha.estoqueAlmoxarifado.fabricanteAlmoxarifado.descricao}" />
	                </h:panelGroup>
	                
	                <h:panelGroup>
	                	<h:outputText value="Validade:" style="font-weight:bold;" /><br/>
	               		<h:outputText value="#{linha.estoqueAlmoxarifado.dataValidade}" style="margin-left:10px">
			            	<f:convertDateTime pattern="dd/MM/yyyy"/>
			            </h:outputText>
				    </h:panelGroup>
				    
				    <h:panelGroup>
	                	<h:outputText value="Quantidade: " style="font-weight:bold;" /><br/>
	  			       	<h:outputText value="#{linha.quantidadeEntrada}"/>
	                </h:panelGroup>
	                
	                 <h:panelGroup>
	                 
	                	<h:outputText value="Valor Unitário: " style="font-weight:bold;" /><br/>
						<h:outputText id="balance" value="#{linha.valorUnitario}">
						    <f:convertNumber currencySymbol="R$" 
						    				 groupingUsed="true"
						                     maxFractionDigits="2" 
						                     type="currency" />
						</h:outputText>
	               </h:panelGroup>
	                
	                 <h:panelGroup>
	                	<h:outputText value="Total: " style="font-weight:bold;" /><br/>
	  			       	<h:outputText value="#{linha.quantidadeEntrada * linha.valorUnitario}">
	  			       		<f:convertNumber currencySymbol="R$" 
						    				 groupingUsed="true"
						                     maxFractionDigits="2" 
						                     type="currency" />
						</h:outputText>
	                </h:panelGroup>
	                
	            </h:panelGrid>  
	        </p:panel>
		</p:dataGrid>
	</div>
</ui:composition>